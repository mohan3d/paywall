(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,a){e.exports=a(58)},32:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var n,s=a(0),r=a.n(s),o=a(23),c=a.n(o),l=(a(32),a(61)),i=a(59),u=a(60),h=a(4),m=a(5),d=a(7),p=a(6),f=a(8),b=a(2),g=a(62),v=a(12),E=a.n(v),j="wallappauthtoken",O="http://localhost:8000/api/".concat("v1");function w(){return localStorage.getItem(j)}function C(){return null!==w()}function k(e){var t=null!==e?e:w(),a={};return null!=t&&(a.Authorization=" Token ".concat(t)),a}var y=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={username:"",password:""},a.handleUsernameChange=a.handleUsernameChange.bind(Object(b.a)(Object(b.a)(a))),a.handlePasswordChange=a.handlePasswordChange.bind(Object(b.a)(Object(b.a)(a))),a.handleLogin=a.handleLogin.bind(Object(b.a)(Object(b.a)(a))),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleLogin",value:function(e){var t,a,n=this;(e.preventDefault(),this.state.username&&this.state.password)&&(t=this.state.username,a=this.state.password,E.a.post("".concat(O,"/login/"),{username:t,password:a}).then(function(e){var t=e.data.token;return localStorage.setItem(j,t),e})).then(function(e){return n.props.history.push("/")}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"form"},r.a.createElement("form",null,r.a.createElement("div",{className:"form-input"},r.a.createElement("label",null,"Username",r.a.createElement("input",{onChange:this.handleUsernameChange,value:this.state.username,type:"text",name:"username"}))),r.a.createElement("div",{className:"form-input"},r.a.createElement("label",null,"Password",r.a.createElement("input",{onChange:this.handlePasswordChange,value:this.state.password,type:"password",name:"password"}))),r.a.createElement("button",{onClick:this.handleLogin},"Login")))}}]),t}(s.Component),P=Object(g.a)(y),S=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleLogout",value:function(){localStorage.removeItem(j),this.props.history.push("/login")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"form"},r.a.createElement("button",{onClick:function(){return e.handleLogout()}},"Sure you want to leave?"))}}]),t}(s.Component),N=Object(g.a)(S),U=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={email:"",username:"",password:""},a.handleEmailChange=a.handleEmailChange.bind(Object(b.a)(Object(b.a)(a))),a.handleUsernameChange=a.handleUsernameChange.bind(Object(b.a)(Object(b.a)(a))),a.handlePasswordChange=a.handlePasswordChange.bind(Object(b.a)(Object(b.a)(a))),a.handleRegister=a.handleRegister.bind(Object(b.a)(Object(b.a)(a))),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleEmailChange",value:function(e){this.setState({email:e.target.value})}},{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleRegister",value:function(e){var t,a,n,s=this;(e.preventDefault(),this.state.email&&this.state.username&&this.state.password)&&(t=this.state.email,a=this.state.username,n=this.state.password,E.a.post("".concat(O,"/register/"),{email:t,username:a,password:n})).then(function(e){return s.props.history.push("/login")}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"form"},r.a.createElement("form",null,r.a.createElement("div",{className:"form-input"},r.a.createElement("label",null,"Email",r.a.createElement("input",{onChange:this.handleEmailChange,value:this.state.email,type:"email",name:"email"}))),r.a.createElement("div",{className:"form-input"},r.a.createElement("label",null,"Username",r.a.createElement("input",{onChange:this.handleUsernameChange,value:this.state.username,type:"text",name:"username"}))),r.a.createElement("div",{className:"form-input"},r.a.createElement("label",null,"Password",r.a.createElement("input",{onChange:this.handlePasswordChange,value:this.state.password,type:"password",name:"password"}))),r.a.createElement("button",{onClick:this.handleRegister},"Register")))}}]),t}(s.Component),L=Object(g.a)(U),M=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={content:""},a.handleShare=a.handleShare.bind(Object(b.a)(Object(b.a)(a))),a.handleChange=a.handleChange.bind(Object(b.a)(Object(b.a)(a))),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleChange",value:function(e){this.setState({content:e.target.value})}},{key:"handleShare",value:function(){this.state.content&&(this.props.share(this.state.content),this.setState({content:""}))}},{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"postbox"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"description"},r.a.createElement("h1",null,"Share your thoughts")),r.a.createElement("div",null,r.a.createElement("div",{className:"postcontent"},r.a.createElement("textarea",{onChange:this.handleChange,value:this.state.content,placeholder:"What's happening?"})),r.a.createElement("div",{className:"controllers"},r.a.createElement("button",{disabled:this.props.posting,onClick:function(){return e.handleShare()}},"Share")))))}}]),t}(s.Component),x=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"post"},r.a.createElement("div",{className:"content"},this.props.post.content))}}]),t}(s.Component),R=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"container"},this.props.unreadPosts>0&&r.a.createElement("div",{className:"updates"},r.a.createElement("button",{className:"unread",onClick:function(){return e.props.updatePosts()}},"You have ",this.props.unreadPosts," new posts")),r.a.createElement("div",{className:"posts"},this.props.posts.map(function(t){return r.a.createElement(x,{onClick:e.props.onClick,key:t.id,post:t})})),r.a.createElement("div",{className:"controllers"},this.props.hasPosts&&r.a.createElement("button",{className:"load-more",onClick:function(){return e.props.loadMore()}},"Load more")))}}]),t}(s.Component),I=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={posts:[],updates:[],posting:!1},a.loadMorePosts=a.loadMorePosts.bind(Object(b.a)(Object(b.a)(a))),a.updatePosts=a.updatePosts.bind(Object(b.a)(Object(b.a)(a))),a.sharePost=a.sharePost.bind(Object(b.a)(Object(b.a)(a))),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleError",value:function(e){console.log(e)}},{key:"loadMorePosts",value:function(){var e=this;(function(){if(null!==n)return E.a.get(n).then(function(e){return e.data}).then(function(e){return n=e.next,e})})().then(function(e){return e.results}).then(function(t){return e.setState(function(e){return{posts:e.posts.concat(t)}})}).catch(function(t){return e.handleError(t)})}},{key:"fetchUpdates",value:function(){var e,t=this;this.state.posts.length&&(e=this.state.posts[0].created,E.a.get("".concat(O,"/posts/").concat(e))).then(function(e){return e.data}).then(function(e){return t.setState({updates:e})}).catch(function(e){return t.handleError(e)})}},{key:"updatePosts",value:function(){this.setState(function(e){return{posts:e.updates.concat(e.posts),updates:[]}})}},{key:"sharePost",value:function(e){var t=this;this.setState({posting:!0}),this.updatePosts(),function(e){return E.a.post("".concat(O,"/posts/"),{content:e},{headers:k(null)})}(e).then(function(e){return e.data}).then(function(e){return[e]}).then(function(e){t.setState(function(t){return{posts:e.concat(t.posts)}}),t.setState({posting:!1})}).catch(function(e){t.handleError(e),t.setState({posting:!1})})}},{key:"componentDidMount",value:function(){var e=this;n="".concat(O,"/posts/"),this.loadMorePosts(),this.timer=setInterval(function(){return e.fetchUpdates()},2e3)}},{key:"componentWillUnmount",value:function(){this.timer=null}},{key:"render",value:function(){return r.a.createElement("div",{className:"wall"},C()&&r.a.createElement(M,{posting:this.state.posting,share:this.sharePost}),!C()&&r.a.createElement("section",{className:"description"},r.a.createElement("h1",null,"See what\u2019s happening in the world right now")),r.a.createElement(R,{posts:this.state.posts,unreadPosts:this.state.updates.length,updatePosts:this.updatePosts,loadMore:this.loadMorePosts,hasPosts:null!==n&&n!=="".concat(O,"/posts/")}))}}]),t}(s.Component),W=(a(56),function(){return r.a.createElement(l.a,null,r.a.createElement("div",null,r.a.createElement("nav",null,r.a.createElement("ul",null,!C()&&r.a.createElement("li",null,r.a.createElement(i.a,{to:"/login"},"Login")),!C()&&r.a.createElement("li",null,r.a.createElement(i.a,{to:"/register"},"Register")),C()&&r.a.createElement("li",null,r.a.createElement(i.a,{to:"/logout"},"Logout")),r.a.createElement("li",{className:"home"},r.a.createElement(i.a,{to:"/"},"Home")))),r.a.createElement(u.a,{path:"/",exact:!0,component:I}),r.a.createElement(u.a,{path:"/login",component:P}),r.a.createElement(u.a,{path:"/logout",component:N}),r.a.createElement(u.a,{path:"/register",component:L})))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,2,1]]]);
//# sourceMappingURL=main.09a8a204.chunk.js.map